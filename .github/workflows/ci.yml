name: Debug Paths Filter

on:
  push:
    paths:
      - '**'

jobs:
  filter:
    name: Debug Paths Filter
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - id: filter
        uses: dorny/paths-filter@v2
        with:
          write-to-files: true
          filters: |
            s3:
              - 'modules/s3_bucket/**'
            ssm:
              - 'modules/ssm_parameter/**'
            unmatched:
              - '**'
              - '!modules/s3_bucket/**'
              - '!modules/ssm_parameter/**'

      - name: Inspect matched files
        run: |
          echo "Matched files for s3:"
          cat ${{ steps.filter.outputs.s3_files }}
          echo "Matched files for ssm:"
          cat ${{ steps.filter.outputs.ssm_files }}
          echo "Matched files for unmatched:"
          cat ${{ steps.filter.outputs.unmatched_files }}

      - name: Debug Git Info
        run: |
         git rev-parse --abbrev-ref HEAD
         git log -1